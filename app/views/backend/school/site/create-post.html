{% extends '../base.html' %}
{% block content %}
<!-- 面包屑 -->
{{ breadcrumb.init([{'url':'','title':'新建文章'}]) }}
<!-- END OF BREADCRUMBS -->
<div class="row">
    <div class="col-xs-12">
        <div class="panel panel-default shadow">
            <div class="panel-heading clearfix">
                <h4 class="panel-title"><i class="fa  fa-file-text-o fa-fw m-r-xxs"></i>新建文章</h4>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-xs-5">
                        <div class="images-cover">
                            <img class="b" width="320px" height="200px" id="indexImage"
                                 {% if post %}
                                 src="http://resource.hizuoye.com/{{post.image}}"
                                 {% else %}
                                 src="http://static.hizuoye.com/images/coverpage_default.png"
                                 {% endif %}>
                            <p class="m-t-xs">上传封面图片<span class="tip">(建议尺寸: 900像素x500像素)</span></p>
                            <input type="file" id="imageUpload" class="image-upload">
                        </div>

                        <div class="editor">
                            <div class="wx-editor-template-list">
                                <ul class="nav nav-tabs">
                                    <li class="active">
                                        <a href="#tab1" data-toggle="tab">
                                            <div class="bg-color bg-success">
                                                <i class="fa fa-header"></i>
                                            </div>
                                            标题
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#tab2" data-toggle="tab">
                                            <div class="bg-color bg-danger">
                                                <i class="fa fa-file-o"></i>
                                            </div>
                                            正文
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#tab3" data-toggle="tab">
                                            <div class="bg-color bg-info">
                                                <i class="fa fa-thumbs-o-up"></i>
                                            </div>
                                            关注
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#tab4" data-toggle="tab">
                                            <div class="bg-color bg-warning">
                                                <i class="fa fa-share-square-o"></i>
                                            </div>
                                            分享
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#tab5" data-toggle="tab">
                                            <div class="bg-color bg-primary">
                                                <i class="fa fa-picture-o"></i>
                                            </div>
                                            图片
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="wx-editor-template-content">
                                <div class="tab-content">
                                    <div class="tab-pane fade in active" id="tab1">1</div>
                                    <div class="tab-pane fade" id="tab2">2</div>
                                    <div class="tab-pane fade" id="tab3">3</div>
                                    <div class="tab-pane fade" id="tab4">4</div>
                                    <div class="tab-pane fade" id="tab5">
                                        <button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#myModal">
                                            上传图片
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-7">
                        <form class="form-horizontal" id="postForm" method="post">
                            <input type="hidden" name="image" id="coverImage" value="{{post.image}}"/>
                            <input type="hidden" value="{{post._id.toString()}}" id="postId"/>
                            <div class="form-group">
                                <label class="col-xs-2 control-label">文章标题：</label>

                                <div class="col-xs-10">
                                    <input class="form-control" type="text" id="postTitle" value="{{post.title}}"
                                           name="title">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-xs-2 control-label">文章栏目：</label>

                                <div class="col-xs-10">
                                    <select name="category" id="category" class="form-control">
                                        <option value="">选择栏目</option>
                                        {% for category in categories %}
                                        <option value="{{category._id.toString()}}"
                                                {% if post && post.category.toString()=== category._id.toString() %}
                                                selected{% endif %}
                                                {% if currentCategory=== category._id.toString() %}
                                                selected {%endif %}>

                                            {{category.name}}
                                        </option>
                                        {% endfor %}
                                        {% if categories.length === 0 %}
                                        {% endif %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-xs-2 control-label">阅读次数：</label>

                                <div class="col-xs-10">
                                    <input type="text" class="form-control" name="visitCount"
                                           id="visitCount" value="{{post && post.visitCount || 0}}">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-xs-2 control-label">分享次数：</label>

                                <div class="col-xs-10">
                                    <input type="text" class="form-control" name="shareCount"
                                           id="shareCount" value="{{post && post.shareCount || 0}}">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-xs-2 control-label">点赞次数：</label>

                                <div class="col-xs-10">
                                    <input type="text" class="form-control" name="like"
                                           id="like" value="{{post && post.like || 0}}">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-xs-2 control-label">首页文章：</label>

                                <div class="col-xs-10">
                                    <input type="radio" name="isSlide" id="useSlide" value="1"
                                           {% if post && post.isSlide %} checked {% endif %}>
                                    <span class="">是</span>
                                    <input type="radio" name="isSlide" id="noSlide" value="0"
                                           {% if !post || !post.isSlide %} checked {% endif %}>
                                    <span class="">否</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-xs-12">
                                    <div class="textarea-container" id="postContent">
                                        <!--<textarea id="postContent" name="content">{{post.content}}</textarea>-->
                                    </div>
                                    <input type="hidden" name="content" id="content" value="{{post.content}}">
                                </div>
                            </div>
                        </form>
                    </div>

                </div>
                <div class="row m-t-lg">
                    <div class="col-md-offset-5 col-md-2">
                        <button class="btn btn-default btn-block" id="savePost">
                            {% if update %} 修改 {% else %} 发布 {% endif %}
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- 文件上传 -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">文件上传</h4>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning">
                    <p>1.单张图片最大不要超过2M，不要发布涉嫌违法的图片。</p>
                    <p>2.在上传过程中，请不要刷新页面，以免导致上传图片失败。</p>
                    <p>3.如您对添加的图片不满意，可点击图片右侧的删除图标，将其从上传队列中删除。</p>
                </div>
                <div class="upload-area slimscroll">
                    <ul class="list-unstyled">
                        <li>
                            <div class="uploadifive-queue-item complete" id="uploadifive-imageUpload-file-0"><a
                                    class="close" href="#">X</a>
                                <div><span class="filename">new_logo.png</span><span class="fileinfo"> - 完成</span></div>
                                <div class="progress">
                                    <div class="progress-bar" style="width: 100%;"></div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default pull-left">上传</button>
                <button type="button" class="btn btn-default">确定</button>
            </div>
        </div>
    </div>
</div>
{% include '../../common/media-lib.html' %}
{% endblock %}

{% block javascript %}
<script src="/js/lib/ueditor/ueditor.config.js"></script>
<script src="/js/lib/ueditor/ueditor.all.js"></script>
<script src="/js/entries/school/site/create-post.js"></script>

{% endblock %}
