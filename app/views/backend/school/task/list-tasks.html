{% extends '../base.html' %}
{% block content %}
<!-- 面包屑 -->
{{ breadcrumb.init([{'url':'','title':'营销活动'}]) }}
<!-- END OF BREADCRUMBS -->
<input type="hidden" id="homeworkId" value="">
<div class="row">
    <div class="col-md-12">
        <div class="panel panel-white">
            <div class="panel-heading clearfix">
                <h4 class="panel-title"><i class="fa fa-list-ul fa-fw m-r-xxs"></i>任务列表</h4>

                <div class="panel-control">
                    <a class="btn btn-success btn-xs" href="/school/tasks/create"
                       id="add-passage-btn">+添加任务</a>
                </div>
            </div>
            <div class="panel-body">
                <div  role="tabpanel">
                    <!-- Nav tabs -->
                    <div class="opts-area">
                    <ul class="nav nav-pills" role="tablist">
                        <li data-state = "" class="item selected">全部</li>
                        <li class="item" data-state = "0">进行中</li>
                        <li class="item" data-state = "1">已关闭</li>
                    </ul>
                    </div>
                    <!-- Tab panes -->
                    <div class="tab-content">
                        <div class="table-responsive">
                            <table id="" class="table">
                                <thead>
                                <tr>
                                    <th></th>
                                    <th>标题</th>
                                    <th>状态</th>
                                    <th>时间</th>
                                    <th>操作</th>
                                </tr>
                                </thead>
                                <tbody id="list-posts">
                                {% for task in tasks %}
                                <tr id="{{task._id.toString()}}" data-state="{{task.state}}">
                                    <td>
                                        {% if task.taskType === 0 %}
                                        {% if task.state === 0 %}
                                        <img src="http://static.hizuoye.com/images/passage.png" width="75px" height="75px"
                                             style="display: inline;">
                                        {% else %}
                                        <img src="http://static.hizuoye.com/images/passage-expire.png" width="75px"
                                             height="75px"
                                             style="display: inline;">
                                        {% endif %}
                                        {% else %}
                                        <div style="width: 75px;">
                                            {% if task.state === 0 %}
                                            <img src="http://static.hizuoye.com/images/activity.png" width="60px" height="60px"
                                                 style="display: inline; margin-top: 12px;">
                                            {% else %}
                                            <img src="http://static.hizuoye.com/images/activity-expire.png" width="60px"
                                                 height="60px"
                                                 style="display: inline; margin-top: 12px;">
                                            {% endif %}

                                        </div>
                                        {% endif%}
                                    </td>
                                    <td>{{task.name}}</td>
                                    <td>{% if task.state === 0
                                        %} 进行中 {% else %} 已结束 {% endif %}</td>
                                    <td>{{task.createdTime | date('Y-m-d',-480)}}</td>
                                    <td>
                                        {% if task.state === 0 %}
                                        <div class="">
                                            <a class="btn-middle a-btn-blue"
                                               href="/school/tasks/{{task._id.toString()}}">管理任务</a>
                                        </div>
                                        {% else %}
                                        <div class="">
                                            <a class="btn-middle a-btn-blue"
                                               href="/school/tasks/{{task._id.toString()}}">查看任务</a>
                                        </div>
                                        {% endif %}

                                        {% if task.state === 0 %}
                                        <div style="margin-top: 15px">
                                            <a class="btn-middle a-btn-red close-task">关闭任务</a>
                                        </div>
                                        {% else %}
                                        <div style="margin-top: 15px">
                                            <a class="btn-middle btn-cursor closed-task-btn">已关闭</a>
                                        </div>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block javascript %}
<script>
    requirejs(['/js/app/school/task/list-tasks.js']);
</script>

{% endblock %}
