{% extends '../../layout.html' %}
{% block content %}
<div class="row">
    <div class="col-xs-12">
        <div class="profile-header">
            <div class="row">
                <div class="col-xs-12">
                    <div class="avatar-upload">
                    </div>
                </div>
                <div class="col-xs-12">
                    <div class="avatar">
                        <img class="img-thumbnail"  {% if user.avatar %} src="<<resourceURL>>/<<student.avatar>>?imageView2/1/w/180/h/180" {% else %}
                             src="/images/default_head.jpg" {% endif %}
                             width="150px"
                             height="150px">
                        <div class="pro-name">
                            <p class="f-white f-s-18 m-r-xxl"><<student.displayName>></p>
                            <p class="f-white f-s-16"><<student.username>></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-xs-2">
        <div class="page-sidebar shadow">
            <ul class="nav nav-pills nav-stacked">
                <li><a href="/teacher/students/<<student._id.toString()>>">基本信息</a></li>
                <li class="active"><a href="/teacher/students/<<student._id.toString()>>/phoneRecords">电话记录</a></li>
                <li><a href="/teacher/students/<<student._id.toString()>>/scoreRecords">积分记录</a></li>
            </ul>
        </div>
    </div>
    <div class="col-xs-10">
        <div class="panel panel-default shadow panel-min-h">
            <div class="panel-heading clearfix">
                <h4 class="panel-title">电话记录</h4>
                <div class="panel-control">
                    <button class="btn btn-default btn-sm" data-toggle="modal" data-target="#recordModal">
                        <i class="glyphicon glyphicon-plus m-r-xxs"></i>
                        添加记录
                    </button>
                </div>
            </div>
            <div class="panel-body">
                <div class="record-list" id="recordList">
                    {% for record in records %}
                    <div class="panel">
                        <div class="panel-heading">
                            <div class="media">
                                <div class="pull-left">
                                    <img class="media-object img-circle"
                                         width="50"
                                         height="50"
                                         {% if record.creator.avatar %}
                                         src="<<resourceURL>>/<<record.creator.avatar>>?imageView2/1/w/50/h/50"
                                         {% else %}
                                         src="/images/default_head.jpg"
                                         {% endif %}
                                    >
                                </div>
                                <div class="media-body">
                                    <div class="record-list-title">
                                        <h4 class="media-heading f-s-16 f-normal m-t-xxs"><<record.content |
                                            subTitle(36)>></h4>
                                        <p class="f-s-12 f-gray m-t-xs">
                                            <span class="m-r-lg">发布时间：<<record.createdTime | date('Y-m-d')>></span>
                                            <span>发布人：<<record.creator.displayName>></span>
                                        </p>
                                    </div>
                                    <div class="spread">
                                        <a class="f-info pull-right panel-collapse f-normal">详细</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-body hides">
                            <p class="record-details"><<record.content>></p>
                        </div>
                    </div>
                    {% endfor %}
                    {% if (records.length === 0) %}
                    <div class="tips">
                        <img class="center-block" src="/images/tips-ku.png">
                        <p class="m-t-lg">当前学生暂无电话沟通记录</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
<input type="hidden" id="studentId" value="<<student._id.toString()>>">
<div class="modal fade" id="recordModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">添加记录</h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal m-t-sm" name="recordForm" id="recordForm">
                    <div class="form-group">
                        <label class="col-xs-2 control-label">记录：</label>
                        <div class="col-xs-9">
                            <textarea class="form-control validate" rows="10" name="content"
                                      data-rules="required"
                                      data-display="记录内容"
                            ></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-xs-offset-2 col-xs-9">
                            <button type="submit" class="btn btn-info">确定</button>
                            <button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block javascript %}

<script src="/js/entries/teacher/manager/view-student.js"></script>

{% endblock %}
